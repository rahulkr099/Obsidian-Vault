Alright Rahul, here comes a **clean, interview-focused backend machine coding mock question** for a **File Upload API** ‚Äî one of the most commonly asked backend tasks, especially when testing cloud knowledge (S3/GCS), validation, and middleware design.

I‚Äôll keep it simple but deep enough for real-world interviews.

---

# ü™£ **Backend Machine Coding Round ‚Äî File Upload API**

### ‚è± Time Limit: 45‚Äì60 minutes

### üéØ Goal: Build a backend service that can:

- Accept file uploads
    
- Validate size & type
    
- Save to server OR cloud (S3/GCS)
    
- Return file URL
    
- Handle errors gracefully
    

---

# üìù **Problem Statement**

Design and implement a **File Upload REST API** that:

- Accepts file(s) from client
    
- Validates:
    
    - Allowed MIME types
        
    - File size limit
        
- Stores the file:
    
    - Locally on server OR
        
    - On a cloud provider (AWS S3, GCS, Cloudflare R2, etc.)
        
- Returns a public or signed access URL
    

Technology allowed:  
Node.js, Express, Multer, AWS SDK, GCS SDK, or custom logic.

---

# üîß **Required Endpoint**

```
POST /upload
```

Content-Type must be:

```
multipart/form-data
```

---

# üì• **Functional Requirements**

### **1Ô∏è‚É£ Accept File Upload**

Accept either:

- `single file` (field: `file`)
    
- or `multiple files` (field: `files[]`) depending on your design.
    

### **2Ô∏è‚É£ Validate MIME Types**

Allowed types example:

- images: jpeg, png, webp
    
- pdf documents
    
- txt files
    

Reject files with unsupported MIME type:

```json
{
  "error": true,
  "message": "Invalid file type"
}
```

### **3Ô∏è‚É£ Validate File Size**

Limit example:

- max 5 MB per file
    
- use middleware for size checking
    

Reject oversized files:

```json
{
  "error": true,
  "message": "File too large"
}
```

### **4Ô∏è‚É£ Save File**

Choose one of the following:

#### Option A: Local Storage

Store file under:

```
/uploads/<randomFileName>
```

#### Option B: Cloud Storage

Upload file to:

- AWS S3
    
- Google Cloud Storage
    
- Cloudflare R2
    
- DigitalOcean Spaces
    

Store metadata in DB or simple in-memory list.

Return the **file URL** given by the cloud provider.

### **5Ô∏è‚É£ Response Format**

On success:

```json
{
  "success": true,
  "fileName": "sample.png",
  "url": "https://yourbucket.s3.amazonaws.com/sample.png",
  "size": 234234
}
```

---

# üß™ **Edge Cases to Handle**

- No file in request ‚Üí 400
    
- Invalid field name ‚Üí 400
    
- File size > limit ‚Üí 413
    
- Wrong MIME type ‚Üí 400
    
- Failure during upload ‚Üí rollback/delete
    
- Bucket permission issues ‚Üí show safe error
    
- Duplicate filename collision ‚Üí use unique UUID for filenames
    
- Client abruptly aborts upload ‚Üí safe cleanup
    
- Large file uploads (multi-part streaming)
    
- Local folder permissions missing ‚Üí error
    

---

# üß± **Security Requirements (Very Important)**

- Never trust file extension (use MIME sniffing)
    
- Prevent path traversal attacks (`../../` in filename)
    
- Never allow direct file system overwrite
    
- Validate content-type on backend
    
- If saving locally:
    
    - Use a safe uploads directory
        
    - Disable execution permissions
        
- If saving to S3:
    
    - Use `putObject` with restricted ACL
        
    - Use pre-signed URLs for secure access
        

---

# üìä **Optional Additional Features**

- Upload multiple files at once
    
- Return list of uploaded files
    
- Add endpoint `GET /files/:id` to view metadata
    
- Add ‚Äúdelete file‚Äù endpoint
    
- Add rate limiting on upload API
    
- Add virus scanning (ClamAV / VirusTotal API)
    
- Add thumbnail generation
    
- Add compression for images or videos
    
- Add presigned upload URLs (client uploads directly to S3)
    

---

# ‚≠ê **Interviewer Follow-Up Questions**

1. Difference between **multipart form-data** and **JSON upload**?
    
2. How to handle large files (chunked upload)?
    
3. How to secure S3 buckets?
    
4. What is a **pre-signed URL** and why use it?
    
5. How to prevent file corruption during upload?
    
6. How to validate MIME type safely?
    
7. How would you handle virus scanning?
    
8. How would you build resumable uploads (like Google Drive / YouTube)?
    
9. What if two users upload files with same name?
    

---

# üåü **Bonus Ideas (Good to Impress)**

- Automatic file cleanup using cron job
    
- Upload progress tracking
    
- Upload retry mechanism
    
- Provide CDN URLs
    
- Generate short-lived signed-URLs for secure viewing
    
- Extract EXIF metadata for images
    
- Optimize images (sharp library)
    

---

If you want the next backend challenge, I can prepare:

‚û°Ô∏è **16. Payment System (mini Razorpay)**  
‚û°Ô∏è **17. Blog Backend**  
‚û°Ô∏è **18. Comment System**  
‚û°Ô∏è **19. Real-time Chat Backend**  
‚û°Ô∏è **20. Notification/Webhook System**

Just tell me the next one!