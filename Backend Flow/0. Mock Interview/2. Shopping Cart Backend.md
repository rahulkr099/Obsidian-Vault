Alright Rahul, here comes a sharp and interview-ready **Backend Machine Coding Round** mock question for a **Shopping Cart Backend**.  
This is one of the most common backend tests because it checks **data modeling, business logic, validations, and consistency** â€” all core backend skills.

---

# âœ… **Backend Machine Coding Round â€” Shopping Cart Backend**

### **â± Time Limit:** 60â€“75 minutes

### **ğŸ¯ Goal:** Build the backend logic for a Shopping Cart Service with stock validation and total computation.

---

# **ğŸ“ Problem Statement**

Design and implement a **Shopping Cart Backend** with APIs to:

- Add items to cart
    
- Remove items from cart
    
- Update quantity of items
    
- Get full cart with total amount
    
- Validate product stock before adding/updating
    

You can choose **in-memory**, **MongoDB**, or **SQL database**.  
Three-layer architecture preferred:

- **Routes**
    
- **Controller**
    
- **Service (business logic)**
    
- (Optional) **Repository layer**
    

---

# **ğŸ› Sample Data Structure**

### **Product**

```json
{
  "id": 101,
  "name": "Wireless Mouse",
  "price": 599,
  "stock": 10
}
```

### **Cart Item**

```json
{
  "productId": 101,
  "quantity": 2
}
```

### **Cart Response Example**

```json
{
  "items": [
    {
      "productId": 101,
      "name": "Wireless Mouse",
      "price": 599,
      "quantity": 2,
      "total": 1198
    }
  ],
  "cartTotal": 1198
}
```

---

# **ğŸ’¡ Required Endpoints**

```
POST   /cart/add
PUT    /cart/update
DELETE /cart/remove/:productId
GET    /cart
```

---

# **ğŸ’¡ Functional Requirements**

### **1ï¸âƒ£ Add to Cart â€” POST /cart/add**

- Input: `{ productId, quantity }`
    
- Validate:
    
    - product exists
        
    - quantity > 0
        
    - quantity â‰¤ product.stock
        
- If item already in cart:
    
    - increase quantity
        
    - but never exceed available stock
        
- Return updated cart.
    

---

### **2ï¸âƒ£ Update Quantity â€” PUT /cart/update**

- Input: `{ productId, quantity }`
    
- Validate:
    
    - cart item must exist
        
    - quantity > 0
        
    - quantity â‰¤ product.stock
        
- Update quantity
    
- Return updated cart.
    

---

### **3ï¸âƒ£ Remove Item â€” DELETE /cart/remove/:productId**

- If product exists in cart â†’ remove it
    
- Else return 404
    
- Return updated cart.
    

---

### **4ï¸âƒ£ Get Cart â€” GET /cart**

- Return detailed cart view:
    
    - each item
        
    - item total (`price * qty`)
        
    - overall `cartTotal`
        

### **5ï¸âƒ£ Stock Validation (Important)**

- If quantity > available stock:
    
    - Reject the operation with 400
        
    - Or adjust automatically (your choice) â€” but explain decision
        

---

# **ğŸ§ª Edge Cases to Handle**

- Adding an item where:
    
    - quantity > stock â†’ reject
        
    - product not found â†’ 404
        
- Removing item not in cart â†’ 404
    
- Updating quantity to 0 â†’ either reject or treat as delete (clarify in interview)
    
- Rapid multiple add/update operations â†’ must not exceed stock
    
- Cart empty â†’ return empty items array + total = 0
    
- Large stock & quantity values â†’ no overflow
    
- Product stock updates happening asynchronously (think concurrency)
    
- Case: stock becomes 0 â†’ remove item from cart or reject update
    
- Price changes in product list â†’ cart should show updated price (interviewer may test this)
    

---

# **ğŸ“¦ Data Modeling (Expected)**

### **Products Table / Collection**

- id
    
- name
    
- price
    
- stock
    

### **Cart Table (per user)**

- userId
    
- items:
    
    - productId
        
    - quantity
        

(You can keep 1 cart per user or global cart â€” depends on your choice.)

---

# **ğŸ”§ Architecture Requirements**

### **Controller Layer**

- Validate input
    
- Send response
    
- Pass data to service layer
    

### **Service Layer**

- Business logic:
    
    - stock check
        
    - quantity update
        
    - total computation
        
    - merging items into cart
        
    - removing items
        

### **Repository Layer (Optional)**

- handle DB or in-memory operations
    

---

# **ğŸ“š Test Cases the Interviewer Expects**

- Add product within stock
    
- Add product exceeding stock
    
- Update quantity within stock
    
- Update quantity exceeding stock
    
- Remove product correctly
    
- Remove non-existing product â†’ 404
    
- Compute cart total correctly
    
- Two different items added â†’ total correct
    
- Updating price in product data â†’ reflected in cart
    
- Add same product twice â†’ merges quantity
    
- Empty cart â†’ total = 0
    

---

# â­ Interviewer Follow-Up Questions

1. How do you handle **concurrency**?  
    (Two users update stock at same time.)
    
2. How would you add **discount coupons**?
    
3. How would you add **tax / shipping costs**?
    
4. How would you support **multiple carts per user**?
    
5. How would you **invalidate cart** when stock changes on backend?
    
6. How would you prevent **race conditions** when adding items?
    
7. How would you design this using **Redis or caching**?
    

---

# ğŸŒŸ Bonus Features (Good to Impress)

- Add **clear cart** endpoint
    
- Add **soft stock locking** (reserve items for 5 minutes)
    
- Add **cart expiry** (expires after 24 hours)
    
- Add **optimistic locking**
    
- Add **event-based stock update** (Kafka-like flow)
    
- Add **undo last action**
    
- Add **cart merge** for guest â†’ logged-in user
    

---

If you want, I can create:

â¡ï¸ **Round 3 Backend â€” Authentication + JWT**  
â¡ï¸ **Round 4 Backend â€” File Upload + Validation**  
â¡ï¸ **Round 5 Backend â€” Payment System Design**  
â¡ï¸ **Round 6 Backend â€” Rate Limiting + Caching**

Just tell me the next round!