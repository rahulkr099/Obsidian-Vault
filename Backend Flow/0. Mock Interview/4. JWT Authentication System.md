Alright Rahul, here comes a clean, realistic, interview-grade **Backend Machine Coding Round** mock question for a **JWT Authentication System**.  
This round is extremely common â€” almost every backend role tests this pattern.

Iâ€™ll keep it simple to understand but strong enough to match real interview expectations.

---

# âœ… **Backend Machine Coding Round â€” JWT Authentication System**

### **â± Time Limit:** 60â€“75 minutes

### **ğŸ¯ Goal:** Build a basic authentication system using **JWT**, including:

- Register
    
- Login
    
- Protected route
    
- JWT issuing + verification
    
- Middleware for authentication
    

---

# **ğŸ“ Problem Statement**

Build a backend service that allows users to:

- Register with email + password
    
- Login and receive a JWT token
    
- Use the JWT token to access protected routes
    

You can use **Node.js/Express**, **MongoDB** or **In-memory** for storage during the test.

The system must follow clean architecture:

- **Routes**
    
- **Controller**
    
- **Service**
    
- **Middleware**
    
- (Optional) **Repository**
    

---

# **ğŸ‘¤ User Model Structure**

```json
{
  "id": "uuid or number",
  "email": "string",
  "passwordHash": "string",
  "createdAt": timestamp
}
```

Passwords must **never** be stored in plain text.

Use bcrypt or any hashing method.

---

# **ğŸ”§ Required Endpoints**

```
POST    /auth/register
POST    /auth/login
GET     /protected   (requires JWT)
```

---

# **ğŸ’¡ Functional Requirements**

### **1ï¸âƒ£ Register â€” POST /auth/register**

Input example:

```json
{
  "email": "rahul@example.com",
  "password": "Secret123"
}
```

Rules:

- Email required
    
- Valid email format
    
- Password required (min 6 chars)
    
- Email must be unique
    
- Store hashed password
    
- Return success message or user details
    

---

### **2ï¸âƒ£ Login â€” POST /auth/login**

Input:

```json
{
  "email": "rahul@example.com",
  "password": "Secret123"
}
```

Rules:

- Check if user exists
    
- Compare password with hashed password
    
- On success:
    
    - Issue JWT token (expiry recommended: 1h)
        

Example response:

```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR..."
}
```

---

### **3ï¸âƒ£ Implement JWT Middleware**

A middleware should:

1. Read the `Authorization: Bearer <token>` header
    
2. Validate the token
    
3. Extract user info (e.g., userId)
    
4. Attach it to `req.user`
    
5. Call next middleware
    

If invalid:

- return **401 Unauthorized**
    

---

### **4ï¸âƒ£ Protected Route â€” GET /protected**

- Only accessible with valid JWT
    
- Should return:
    

```json
{
  "message": "Access granted",
  "user": { ... }
}
```

---

# **ğŸ§ª Edge Cases to Handle**

- Register with existing email â†’ return **409 Conflict**
    
- Register with invalid email â†’ **400**
    
- Register with weak/short password â†’ **400**
    
- Login with wrong password â†’ **401**
    
- Login with non-existing email â†’ **404**
    
- No JWT provided â†’ **401**
    
- Invalid JWT â†’ **401**
    
- Expired JWT â†’ **401**
    
- Token not in â€œBearer â€ format â†’ reject
    
- Upper/lowercase mismatch in email (normalize emails)
    

---

# **ğŸ” Security Expectations (Very Important)**

Interviewer will judge these strictly:

- Password **must be hashed**
    
- JWT **must have expiry**
    
- Never include password in API response
    
- Use environment Variables for JWT secret
    
- Validate inputs strongly
    
- Return consistent error structures
    

---

# **ğŸ“¦ Recommended Response Structure**

### Success

```json
{
  "success": true,
  "message": "Logged in successfully",
  "token": "..."
}
```

### Error

```json
{
  "error": true,
  "message": "Invalid credentials"
}
```

---

# â­ Interviewer Follow-Up Questions

1. How would you handle JWT **refresh tokens**?
    
2. How would you **invalidate JWT** without waiting for expiry?
    
3. How would you store JWT on frontend securely?
    
4. How would you prevent **brute force attacks** during login?
    
5. Why is hashing important? Why not encrypt passwords?
    
6. How would you add **role-based access control** (RBAC)?
    
7. What happens if JWT secret is leaked?
    

---

# ğŸŒŸ Bonus Features (Impressive Add-ons)

- Add `/auth/refresh` endpoint
    
- Add `/auth/logout` with token blacklist
    
- Add rate limiting on login (max 5 attempts/min)
    
- Add email verification flow
    
- Add password reset using email OTP
    
- Add CSRF-safe cookie-based JWT flow
    

---

If you want, I can prepare next backend rounds like:

â¡ï¸ **5. File Upload System (S3 + Validation)**  
â¡ï¸ **6. Rate Limiting + Caching (Redis)**  
â¡ï¸ **7. Order System + Inventory Locking**  
â¡ï¸ **8. WebSockets Chat Backend**

Just tell me the next one!